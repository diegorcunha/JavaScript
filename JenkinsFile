pipeline {
    agent any 

    stages {
        stage('Build') { 
	    when {
                branch "master"
	    }
            steps { 
		sh '''#!/bin/sh
			echo "Building..."
			gcloud auth configure-docker
			docker build -t testscrip:${BUILD_NUMBER} . 
			docker tag testscript:${BUILD_NUMBER} "gcr.io/analog-pilot-238717/testscript:${BUILD_NUMBER}"
			docker push "gcr.io/analog-pilot-238717/testscript:${BUILD_NUMBER}"
		'''
            }
        }
        stage('Test'){
            steps {
		echo "Test"
            }
        }
	
    }
}
