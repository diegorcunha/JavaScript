pipeline {
     environment {
        registry = "diegorcunha/testscript"
        registryCredential = 'analog-pilot-238717'
        dockerImage = ''
      }

    agent {
    kubernetes {
      cloud 'kubernetes'
      label 'docker-slave'
      defaultContainer 'docker-slave'
      }
    }
   stages{
      stage('Build') {
        steps {
          echo "Build docker image"
          script {
            dockerImage = docker.build registry + ":$BUILD_NUMBER"
       
                }
            }
        }
        
       stage('Test') {
         steps {
           echo "Test the Image"
           script {
             sh 'docker --version'
                }
            }
        }
        
      }
}
